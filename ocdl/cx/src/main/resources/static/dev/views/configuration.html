<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>OCDL Configuration</title>

    <link rel="stylesheet" href="../assets2/css/animate.min.css">
    <link rel="stylesheet" href="../assets2/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets2/css/font-awesome.min.css">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="../assets2/css/templatemo-style.css">
    <link rel="stylesheet" href="../assets2/css/SwitchServer.css">
    <link href="../assets2/css/flipycard.css" rel="stylesheet">
    <link href="../assets2/css/SyntaxHighlighter.css" type="text/css" rel="stylesheet">
    <link href="../assets2/css/menu.css" rel="stylesheet">
    <link href="../assets2/css/infoStatus.css" rel="stylesheet">
    <link href="../assets2/css/configuration.css" rel="stylesheet">


</head>
<body>



<!-- end preloader -->


<!-- start navigation -->
<nav class="navbar navbar-default templatemo-nav" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
                <span class="icon icon-bar"></span>
            </button>
            <img href="#" alt="OCDL" class="navbar-brand" src="../assets2/images/Brand4.png" />
            <label id="projectName" style="color: black; margin-top: 30px; margin-left: 20px;"></label>
        </div>
        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#top">FILE</a></li>
                <li><a href="#about">MODIFY</a></li>
                <li><a href="#team">TOOLS</a></li>
                <li><a href="#portfolio">TEAM</a></li>
                <li><a href="#contact">CONTACT</a></li>
            </ul>
        </div>
    </div>
</nav>

<header style="background-color:#000000;">
    <div class="container" >
        <div class="row" style="display:flex;justify-content:center;align-items:center;">
            <div id="informationBlock" style="margin: auto;" class="col-md-6 col-sm-3 col-xs-3">
                <label class="col-md-4">User: <label id="username" style="color: #47C6F8">TempUser</label></label>
                <label class="col-md-4">Rescourse: <label id="rescourse" style="color: #47C6F8" class="status_NoneR"></label></label>
                <label class="col-md-4">Status: <label id="status" class="status_disconnected"></label></label>
            </div>
            <div class="col-md-2 col-sm-3 col-xs-3">
                <a id="serverCtl" href="javascript:selectJupyterServer(user_id,user_account,user_password);" class="toggle toggle--on navbar-right"></a>
            </div>
            <div class="col-md-2 col-sm-3 col-xs-3" style="height:40px;">
                <!--	<p>	<button id="flapBtn" class="btn btn-8 btn-8g"><i class="fa fa-refresh"></i><span id="flaptext">Template</span></button>-->
                <span class=" hi-icon-wrap hi-icon-effect-5 hi-icon-effect-5a ">
					<a  href="javascript:submitToGit();" class="hi-icon hi-icon-earth roundA">Git</a>

				</span>

                <span class=" hi-icon-wrap hi-icon-effect-5 hi-icon-effect-5a">
					<a  id="flapBtn"  href="#" class="hi-icon hi-icon-refresh roundA">Flap</a>
				</span>


                </p>
            </div>
            <div class="col-md-2 col-sm-3 col-xs-3">
                <ul class="social-icon">
                    <li><span>Sign in with </span></li>
                    <li><a id="login_f" href="#" class="fa fa-facebook"></a></li>
                    <li><a id="login_t" href="#" class="fa fa-twitter"></a></li>
                </ul>

            </div>
        </div>
    </div>
</header>

<!-- start home -->
<section id="config">
                <div class="container2 w3layouts agileits">

                    <div class="login w3layouts agileits">
                        <div class="col-md-12 wow fadeIn" data-wow-offset="50" data-wow-delay="0.6s">
                            <i class="fa fa-cogs"></i>
                        </div>
                        <div class="col-md-12 wow fadeIn" style="margin-top: 80px;" data-wow-offset="50" data-wow-delay="0.6s">
                            <p>We can help you to deploy deep learning project in a convenient, fast and reliable way. We're totally offering more than 50 templates, 20 type of networks, 30 kinds of layers and 20 kinds blocks templates for you. From training to assessment, all you need to you is just one click. </p>
                        </div>

                        <div class="clear"></div>
                    </div>


                    <div class="register w3layouts agileits">
                        <h2>Configuration Center</h2>
                        <form action="#" method="post">
                            <label class="col-md-4" for="name">Project Name: </label> <input id="name" class="col-md-8" type="text" Name="name" placeholder="Project Name" required="">
                            <label class="col-md-4" for="git">Git Repository: </label> <input id="git" class="col-md-8" type="text" Name="git" placeholder="Git Repository" required="">
                            <label class="col-md-4" for="k8Url">K8S URL: </label>    <input id="k8Url" class="col-md-8" type="text" Name="k8Url" placeholder="K8S URL" required="">
                            <label class="col-md-4" for="templateUrl">Template Path: </label>  <input id="templateUrl" class="col-md-8" type="text" Name="templateUrl" placeholder="Template Path" required="">
                            <label class="col-md-4" for="suffix">Model File Suffix: </label>  <input id="suffix" class="col-md-8" type="text" Name="suffix" placeholder="Suffix" required="">
                            <label class="col-md-4" for="modelType">Model Type: </label>  <input id="modelType" class="col-md-8" type="text" Name="modelType" placeholder="ModelType" required="">
                        </form>
                        <div class="send-button w3layouts agileits">
                                <input type="submit" value="Confirm" onclick="updateConfiguration()">
                        </div>
                        <div class="clear"></div>
                    </div>

                    <div class="clear"></div>

            </div>

</section>


<script src="../assets2/js/jquery.js"></script>
<script src="../assets2/js/bootstrap.min.js"></script>
<script src="../assets2/js/jquery.singlePageNav.min.js"></script>

<script language="JavaScript">
    var token = GetQueryString("token");
    initConfigInfo();


    function initConfigInfo() {
        $.ajax({
            url: "/rest/projects",
            contentType: 'application/json',
            dataType: "json",
            type: "GET",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("AUTH_TOKEN", token);
            },
            success: function(data) {
                ajaxMessageReader(data,function (data) {
                    var projectName=$("#name");
                    var projectName2=$("#projectName");
                    var k8Url= $("#k8Url");
                    var git = $("#git");
                    var templatePath = $("#templateUrl");
                    var suffix = $("#suffix");
                    var modelType = $("#")

                    projectName.val(data['projectName']);
                    k8Url.val(data['k8Url']);
                    git.val(data['gitPath']);
                    templatePath.val(data['templatePath']);
                    projectName2.text(data['projectName']);

                })
            },
            error: function (data) {
            }
        })
    }
    
    function updateConfiguration() {
        $.ajax({
            url: "/rest/projects/config",
            contentType: 'application/json',
            dataType: "json",
            beforeSend: function (xhr) {
                xhr.setRequestHeader("AUTH_TOKEN", token);
            },
            data:
                JSON.stringify({
                    projectName: $("#name").val(),
                    gitPath: $("#git").val(),
                    k8Url: $("#k8Url").val(),
                    templatePath: $("#templateUrl").val(),
                    suffix:$("#suffix").val(),
                    modelType:$("#modelType").val()
                }),
            type: "PUT",
            timeout: 0,
            success: function(data){
                ajaxMessageReader(data,function (data) {
                        $("#projectName").text($("#name").val());
                        alert("Update Successful");
                })
            },
            error: function (data) {
            }
        })
    }
    function ajaxMessageReader(response, func){
        		if(response.code=="400"){
                    alert(response.get("message"));
                }else if(response.code=="200"){
                    func(response.data);
                }
    }

    function GetQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }
</script>





</body>
</html>